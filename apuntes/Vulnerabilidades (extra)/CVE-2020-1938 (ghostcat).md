## ğŸ’€ Â¿QuÃ© es **Ghostcat** (CVE-2020-1938)?

Ghostcat es una vulnerabilidad **crÃ­tica** descubierta en el conector [[AJP - Apache JServ Protocol]] (Apache JServ Protocol) usado por **Apache Tomcat**.

---

### ğŸ“Œ Â¿QuÃ© permite?

Permite a un atacante **leer archivos internos del servidor web** (como `WEB-INF/web.xml`) **e incluso cargar archivos JSP maliciosos** para ejecuciÃ³n remota de cÃ³digo (RCE), si no hay restricciones.

---

### ğŸ”¥ Afecta a:

- Apache Tomcat desde versiones antiguas hasta:
    
    - **Tomcat 9.0.30**
        
    - **Tomcat 8.5.50**
        
    - **Tomcat 7.0.99**
        

> **Â¡Y estÃ¡ presente por defecto!** El puerto `8009` (AJP) estÃ¡ habilitado y expone una puerta trasera si no estÃ¡ correctamente filtrado.

---

### ğŸ¯ Â¿QuÃ© permite Ghostcat?

1. Leer archivos como:
    
    - `WEB-INF/web.xml`
        
    - `WEB-INF/web.xml.bak`
        
    - Archivos de configuraciÃ³n
        
    - `.jsp`, `.class`, `.properties`
        
2. Subir archivos (con mÃ©todos como `PUT`) si no estÃ¡ bien configurado.
    
3. En algunos casos: **ejecutar cÃ³digo JSP malicioso** â†’ ***RCE ğŸ˜ˆ***

---

## ğŸ§ª Â¿CÃ³mo se explota?

Con herramientas como:

### ğŸ“¦ [ajpShooter (Python)](https://github.com/00theway/Ghostcat-CNVD-2020-10487)

```bash
git clone https://github.com/00theway/Ghostcat-CNVD-2020-10487
cd Ghostcat-CNVD-2020-10487
python3 ajpShooter.py -t 10.2.74.32 -p 8009 -f WEB-INF/web.xml
```

> Esto intenta leer el archivo `WEB-INF/web.xml` a travÃ©s del conector AJP.

### âš ï¸ Si tenÃ©s Ã©xito:

Vas a ver XML con configuraciones internas. Ya con eso podrÃ­as encontrar usuarios, rutas, o preparar un payload para subir.

---

## ğŸ›¡ Â¿Por quÃ© es peligroso?

Porque **ni siquiera se necesita estar autenticado** en Tomcat, ni tener una sesiÃ³n vÃ¡lida. Solo conectarse al puerto AJP expuesto.

---

## ğŸš¨ Recomendaciones (para mitigar)

- **Cerrar el puerto 8009** si no se usa.
    
- O configurar `address="127.0.0.1"` en el conector AJP para que solo escuche local.
    
- O usar `secretRequired="true"` con `secret="clave"` para autenticaciÃ³n.
    

---

## ğŸ§  En resumen:

|Cosa|Detalle|
|---|---|
|Nombre|Ghostcat|
|CVE|CVE-2020-1938|
|Protocolo afectado|AJP (Apache JServ Protocol)|
|Puerto tÃ­pico|8009|
|QuÃ© permite|LFI (leer archivos) â†’ posible RCE|
|Afecta a|Apache Tomcat â‰¤ 9.0.30 (y otras versiones previas)|
|Riesgo|ğŸŸ¥ CrÃ­tico â€“ ejecuciÃ³n remota de cÃ³digo (RCE)|

[[vulnerabilidades_extra]]